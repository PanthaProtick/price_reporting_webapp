{% extends "layout.html" %}

{% block title %}Review Shops{% endblock %}

{% block content %}
<div class="container mt-4">
  <!-- Page Header -->
  <div class="row mb-4">
    <div class="col">
      <h1 class="mb-2">
        <i class="bi bi-shop me-2"></i>Review Shop Proposals
      </h1>
      <p class="text-muted">
        <i class="bi bi-info-circle me-1"></i>
        Review and approve pending shop submissions from community members.
      </p>
    </div>
  </div>

  {% if proposals and proposals|length > 0 %}
    <!-- Summary Badge -->
    <div class="alert alert-info mb-4">
      <i class="bi bi-clipboard-check me-2"></i>
      <strong>{{ proposals|length }}</strong> proposal{{ 's' if proposals|length > 1 else '' }} awaiting your review
    </div>

    <!-- Proposals Grid -->
    <div class="row g-4">
      {% for p in proposals %}
      <div class="col-12">
        <div class="card shadow-sm hover-lift h-100">
          <div class="card-body">
            <div class="row align-items-center">
              <!-- Shop Details -->
              <div class="col-lg-8">
                <h5 class="card-title mb-3">
                  <i class="bi bi-shop text-primary me-2"></i>
                  {{ p.proposed_name }}
                </h5>
                
                <div class="row g-3">
                  <div class="col-md-6">
                    <p class="mb-2">
                      <i class="bi bi-geo-alt text-muted me-2"></i>
                      <strong>Address:</strong><br>
                      <span class="ms-4">{{ p.proposed_address }}</span>
                    </p>
                  </div>
                  
                  <div class="col-md-6">
                    <p class="mb-2">
                      <i class="bi bi-globe text-muted me-2"></i>
                      <strong>Coordinates:</strong><br>
                      {% if p.latitude and p.longitude %}
                        <span class="ms-4">
                          {{ '%.6f'|format(p.latitude) }}, {{ '%.6f'|format(p.longitude) }}
                          <a href="https://www.google.com/maps?q={{ p.latitude }},{{ p.longitude }}" 
                             target="_blank" 
                             class="btn btn-sm btn-outline-primary ms-2">
                            <i class="bi bi-map"></i> View Map
                          </a>
                        </span>
                      {% else %}
                        <span class="ms-4 text-muted">Not provided</span>
                      {% endif %}
                    </p>
                  </div>
                </div>

                <p class="mb-0 mt-3">
                  <i class="bi bi-person text-muted me-2"></i>
                  <strong>Proposed by:</strong>
                  <span class="badge bg-secondary">{{ p.proposed_by }}</span>
                </p>
              </div>

              <!-- Action Buttons -->
              <div class="col-lg-4 mt-3 mt-lg-0">
                <div class="d-grid gap-2">
                  <form method="post" action="/admin/review/shops/approve">
                    <input type="hidden" name="id" value="{{ p.id }}">
                    <button type="submit" class="btn btn-success w-100">
                      <i class="bi bi-check-circle me-2"></i>Approve Shop
                    </button>
                  </form>
                  
                  <form method="post" action="/admin/review/shops/reject">
                    <input type="hidden" name="id" value="{{ p.id }}">
                    <button type="submit" class="btn btn-outline-danger w-100">
                      <i class="bi bi-x-circle me-2"></i>Reject Proposal
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <!-- Empty State -->
    <div class="text-center py-5">
      <div class="mb-4">
        <i class="bi bi-check2-circle" style="font-size: 4rem; color: var(--bs-success);"></i>
      </div>
      <h3 class="text-muted mb-3">All Caught Up!</h3>
      <p class="text-muted">No shop proposals are pending review at this time.</p>
      <a href="/" class="btn btn-primary mt-3">
        <i class="bi bi-house me-2"></i>Back to Dashboard
      </a>
    </div>
  {% endif %}
</div>

<style>
.hover-lift {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.hover-lift:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15) !important;
}

.card-title {
  color: var(--bs-dark);
  font-weight: 600;
}
</style>

{% endblock %}
